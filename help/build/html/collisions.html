<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Ship-Ship Collision Calculations &#8212; OMRAT 0.3.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=ff28a369" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=b5312e80" />
    <script src="_static/documentation_options.js?v=4621528c"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Powered Grounding and Allision" href="powered.html" />
    <link rel="prev" title="Drifting Risk Calculations" href="drifting.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">OMRAT</a></h1>



<p class="blurb">Open Maritime Risk Analysis Tool - QGIS Plugin</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=axelande&repo=OMRAT&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Project Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_guide.html">User Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory &amp; Calculations</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="theory.html">Mathematical Foundations</a></li>
<li class="toctree-l1"><a class="reference internal" href="drifting.html">Drifting Risk Calculations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Ship-Ship Collision Calculations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#head-on-collisions">Head-On Collisions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#overtaking-collisions">Overtaking Collisions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#crossing-collisions">Crossing Collisions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bend-collisions">Bend Collisions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#calculation-workflow">Calculation Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#summary-of-equations">Summary of Equations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="powered.html">Powered Grounding and Allision</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Code Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="drifting.html" title="previous chapter">Drifting Risk Calculations</a></li>
      <li>Next: <a href="powered.html" title="next chapter">Powered Grounding and Allision</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="ship-ship-collision-calculations">
<span id="collisions"></span><h1>Ship-Ship Collision Calculations<a class="headerlink" href="#ship-ship-collision-calculations" title="Link to this heading">¶</a></h1>
<p>This chapter describes OMRAT’s calculations for ship-ship collision
risk. Four types of collision encounters are modelled: head-on,
overtaking, crossing, and bend collisions, all based on the equations
in Hansen (2008).</p>
<nav class="contents local" id="in-this-chapter">
<p class="topic-title">In this chapter</p>
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id9">Overview</a></p></li>
<li><p><a class="reference internal" href="#head-on-collisions" id="id10">Head-On Collisions</a></p>
<ul>
<li><p><a class="reference internal" href="#geometry" id="id11">Geometry</a></p></li>
<li><p><a class="reference internal" href="#equations-hansen-eq-4-2-4-4" id="id12">Equations (Hansen Eq. 4.2–4.4)</a></p></li>
<li><p><a class="reference internal" href="#default-causation-factor" id="id13">Default causation factor</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#overtaking-collisions" id="id14">Overtaking Collisions</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id15">Geometry</a></p></li>
<li><p><a class="reference internal" href="#equations-hansen-eq-4-5" id="id16">Equations (Hansen Eq. 4.5)</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id17">Default causation factor</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#crossing-collisions" id="id18">Crossing Collisions</a></p>
<ul>
<li><p><a class="reference internal" href="#id3" id="id19">Geometry</a></p></li>
<li><p><a class="reference internal" href="#equations-hansen-eq-4-6" id="id20">Equations (Hansen Eq. 4.6)</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id21">Default causation factor</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#bend-collisions" id="id22">Bend Collisions</a></p>
<ul>
<li><p><a class="reference internal" href="#id5" id="id23">Geometry</a></p></li>
<li><p><a class="reference internal" href="#equations" id="id24">Equations</a></p></li>
<li><p><a class="reference internal" href="#id6" id="id25">Default causation factor</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#calculation-workflow" id="id26">Calculation Workflow</a></p></li>
<li><p><a class="reference internal" href="#summary-of-equations" id="id27">Summary of Equations</a></p></li>
</ul>
</nav>
<section id="overview">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>Ship-ship collisions occur when two vessels occupy the same space at the
same time. The IWRAP methodology models this by calculating the
<strong>geometric number of collision candidates</strong> – the expected number of
close encounters per year assuming no evasive action – and then
multiplying by a <strong>causation factor</strong> to get the actual accident
frequency.</p>
<a class="reference internal image-reference" href="_images/collision_types.svg"><img alt="Four collision types: head-on, overtaking, crossing, and bend" src="_images/collision_types.svg" style="width: 100%;" />
</a>
<p>The general formula is:</p>
<div class="math notranslate nohighlight">
\[F_{\text{collision}} = N_G \times P_C\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_G\)</span> = geometric collision candidates per year</p></li>
<li><p><span class="math notranslate nohighlight">\(P_C\)</span> = causation probability (IALA default values)</p></li>
</ul>
<div class="source-code-ref pipeline docutils container">
<p><strong>Pipeline orchestrator:</strong> <code class="docutils literal notranslate"><span class="pre">compute/ship_collision_model.py:526</span></code> – <a class="reference external" href="https://github.com/axelande/OMRAT/blob/main/compute/ship_collision_model.py#L526">run_ship_collision_model()</a></p>
</div>
</section>
<section id="head-on-collisions">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Head-On Collisions</a><a class="headerlink" href="#head-on-collisions" title="Link to this heading">¶</a></h2>
<p>Head-on collisions occur between vessels travelling in <strong>opposite
directions</strong> on the same leg. This is the classical encounter type for
narrow shipping lanes.</p>
<section id="geometry">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Geometry</a><a class="headerlink" href="#geometry" title="Link to this heading">¶</a></h3>
<p>Two streams of traffic travel in opposite directions. The collision
probability depends on the lateral overlap of their position
distributions.</p>
</section>
<section id="equations-hansen-eq-4-2-4-4">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Equations (Hansen Eq. 4.2–4.4)</a><a class="headerlink" href="#equations-hansen-eq-4-2-4-4" title="Link to this heading">¶</a></h3>
<p>The geometric number of collision candidates is:</p>
<div class="math notranslate nohighlight">
\[N_G = \frac{Q_1}{V_1} \times \frac{Q_2}{V_2} \times V_{ij}
      \times P_G \times L_w \times \frac{1}{\text{sec/year}}\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Q_1, Q_2\)</span> = traffic volume in each direction (ships/year)</p></li>
<li><p><span class="math notranslate nohighlight">\(V_1, V_2\)</span> = vessel speeds (m/s)</p></li>
<li><p><span class="math notranslate nohighlight">\(V_{ij} = V_1 + V_2\)</span> = relative closing speed (m/s)</p></li>
<li><p><span class="math notranslate nohighlight">\(L_w\)</span> = leg segment length (m)</p></li>
<li><p><span class="math notranslate nohighlight">\(P_G\)</span> = geometric collision probability</p></li>
</ul>
<p>The term <span class="math notranslate nohighlight">\(Q/V\)</span> converts from traffic frequency (ships/year) to
traffic density (ships/m), accounting for the time ships spend on the
leg.</p>
<p>The geometric collision probability is:</p>
<div class="math notranslate nohighlight">
\[P_G = \Phi\!\left(\frac{\mu_{ij} + B_{ij}}{\sigma_{ij}}\right)
    - \Phi\!\left(\frac{\mu_{ij} - B_{ij}}{\sigma_{ij}}\right)\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mu_{ij} = \mu_1 + \mu_2\)</span> – combined mean lateral distance
(head-on: positions add because ships face opposite directions)</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma_{ij} = \sqrt{\sigma_1^2 + \sigma_2^2}\)</span> – combined
standard deviation</p></li>
<li><p><span class="math notranslate nohighlight">\(B_{ij} = (B_1 + B_2) / 2\)</span> – average vessel breadth (collision
width)</p></li>
<li><p><span class="math notranslate nohighlight">\(\Phi\)</span> = standard normal CDF</p></li>
</ul>
<div class="source-code-ref docutils container">
<p><code class="docutils literal notranslate"><span class="pre">compute/basic_equations.py:46</span></code> – <a class="reference external" href="https://github.com/axelande/OMRAT/blob/main/compute/basic_equations.py#L46">get_head_on_collision_candidates()</a></p>
</div>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">Head-on collision candidate calculation (compute/basic_equations.py)</span><a class="headerlink" href="#id7" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># Relative closing speed for head-on collision</span>
    <span class="n">V_ij</span> <span class="o">=</span> <span class="n">V1</span> <span class="o">+</span> <span class="n">V2</span>

    <span class="c1"># Mean lateral distance between vessels (head-on: opposite directions)</span>
    <span class="n">mu_ij</span> <span class="o">=</span> <span class="n">mu1</span> <span class="o">+</span> <span class="n">mu2</span>

    <span class="c1"># Combined standard deviation</span>
    <span class="n">sigma_ij</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">sigma1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sigma2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Average vessel breadth (collision width)</span>
    <span class="n">B_ij</span> <span class="o">=</span> <span class="p">(</span><span class="n">B1</span> <span class="o">+</span> <span class="n">B2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="c1"># Geometric collision probability using cumulative normal distribution</span>
    <span class="c1"># P_G = Φ((μ_ij + B_ij)/σ_ij) - Φ((μ_ij - B_ij)/σ_ij)</span>
    <span class="k">if</span> <span class="n">sigma_ij</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">P_G</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">((</span><span class="n">mu_ij</span> <span class="o">+</span> <span class="n">B_ij</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma_ij</span><span class="p">)</span> <span class="o">-</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">((</span><span class="n">mu_ij</span> <span class="o">-</span> <span class="n">B_ij</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma_ij</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># If no variance, check if collision is certain (within beam)</span>
        <span class="n">P_G</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">np_abs</span><span class="p">(</span><span class="n">mu_ij</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">B_ij</span> <span class="k">else</span> <span class="mf">0.0</span>

    <span class="c1"># Number of geometric collision candidates</span>
    <span class="c1"># Hansen Eq. 4.2-4.4:</span>
    <span class="c1"># N_G = (Q1/V1) × (Q2/V2) × V_ij × P_G × L_w</span>
    <span class="c1"># Where Q/V converts frequency (ships/year) to density (ships/meter)</span>
    <span class="c1"># This gives the correct dimension: collision candidates per year</span>

    <span class="c1"># Avoid division by zero</span>
    <span class="k">if</span> <span class="n">V1</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">V2</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>

    <span class="c1"># Convert to ships per meter (density)</span>
    <span class="c1"># Q is ships/year, V is m/s, so Q/V gives ships/year / (m/s) = ships * s / (year * m)</span>
    <span class="c1"># We need to convert: ships/year / (m/year) to get ships/m</span>
    <span class="c1"># V_year = V * seconds_per_year</span>
    <span class="n">seconds_per_year</span> <span class="o">=</span> <span class="mf">365.25</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span>
    <span class="n">density1</span> <span class="o">=</span> <span class="n">Q1</span> <span class="o">/</span> <span class="p">(</span><span class="n">V1</span> <span class="o">*</span> <span class="n">seconds_per_year</span><span class="p">)</span>  <span class="c1"># ships per meter</span>
    <span class="n">density2</span> <span class="o">=</span> <span class="n">Q2</span> <span class="o">/</span> <span class="p">(</span><span class="n">V2</span> <span class="o">*</span> <span class="n">seconds_per_year</span><span class="p">)</span>  <span class="c1"># ships per meter</span>

    <span class="c1"># N_G = density1 × density2 × V_ij × P_G × L_w × seconds_per_year</span>
    <span class="c1"># This gives collision candidates per year</span>
    <span class="n">N_G</span> <span class="o">=</span> <span class="n">density1</span> <span class="o">*</span> <span class="n">density2</span> <span class="o">*</span> <span class="n">V_ij</span> <span class="o">*</span> <span class="n">P_G</span> <span class="o">*</span> <span class="n">L_w</span> <span class="o">*</span> <span class="n">seconds_per_year</span>

    <span class="k">return</span> <span class="n">N_G</span>
</pre></div>
</div>
</div>
</section>
<section id="default-causation-factor">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Default causation factor</a><a class="headerlink" href="#default-causation-factor" title="Link to this heading">¶</a></h3>
<div class="math notranslate nohighlight">
\[P_C = 4.9 \times 10^{-5} \quad \text{(Fujii et al. 1974)}\]</div>
</section>
</section>
<section id="overtaking-collisions">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Overtaking Collisions</a><a class="headerlink" href="#overtaking-collisions" title="Link to this heading">¶</a></h2>
<p>Overtaking collisions occur between vessels travelling in the <strong>same
direction</strong> at different speeds. The faster vessel catches up to the
slower one.</p>
<section id="id1">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Geometry</a><a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>Both vessels travel in the same direction. The collision probability
depends on the speed difference (overtaking is only possible if
<span class="math notranslate nohighlight">\(V_{\text{fast}} &gt; V_{\text{slow}}\)</span>) and the lateral overlap of
their distributions.</p>
</section>
<section id="equations-hansen-eq-4-5">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Equations (Hansen Eq. 4.5)</a><a class="headerlink" href="#equations-hansen-eq-4-5" title="Link to this heading">¶</a></h3>
<p>The formula is structurally identical to head-on, but with different
relative speed and lateral offset:</p>
<div class="math notranslate nohighlight">
\[V_{ij} = V_{\text{fast}} - V_{\text{slow}}\]</div>
<div class="math notranslate nohighlight">
\[\mu_{ij} = \mu_{\text{fast}} - \mu_{\text{slow}}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <span class="math notranslate nohighlight">\(V_{\text{fast}} \leq V_{\text{slow}}\)</span>, overtaking is
impossible and the result is zero.</p>
</div>
<p>The geometric probability <span class="math notranslate nohighlight">\(P_G\)</span>, combined standard deviation
<span class="math notranslate nohighlight">\(\sigma_{ij}\)</span>, and breadth <span class="math notranslate nohighlight">\(B_{ij}\)</span> are calculated
identically to the head-on case.</p>
<div class="source-code-ref docutils container">
<p><code class="docutils literal notranslate"><span class="pre">compute/basic_equations.py:147</span></code> – <a class="reference external" href="https://github.com/axelande/OMRAT/blob/main/compute/basic_equations.py#L147">get_overtaking_collision_candidates()</a></p>
</div>
</section>
<section id="id2">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Default causation factor</a><a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<div class="math notranslate nohighlight">
\[P_C = 1.1 \times 10^{-4} \quad \text{(Fujii et al. 1974)}\]</div>
</section>
</section>
<section id="crossing-collisions">
<h2><a class="toc-backref" href="#id18" role="doc-backlink">Crossing Collisions</a><a class="headerlink" href="#crossing-collisions" title="Link to this heading">¶</a></h2>
<p>Crossing collisions occur at intersections where two legs cross at an
angle <span class="math notranslate nohighlight">\(\theta\)</span>. This is common at traffic separation scheme
junctions, port approaches, and areas where multiple routes converge.</p>
<section id="id3">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">Geometry</a><a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>Two traffic streams cross at angle <span class="math notranslate nohighlight">\(\theta\)</span>. The collision zone
is an area around the intersection point whose size depends on vessel
dimensions and the crossing angle.</p>
</section>
<section id="equations-hansen-eq-4-6">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Equations (Hansen Eq. 4.6)</a><a class="headerlink" href="#equations-hansen-eq-4-6" title="Link to this heading">¶</a></h3>
<div class="math notranslate nohighlight">
\[N_G = \frac{Q_1 \times Q_2 \times D_{ij}}
           {V_1 \times V_2 \times |\sin\theta|
            \times \text{sec/year}}\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\theta\)</span> = crossing angle (radians)</p></li>
<li><p><span class="math notranslate nohighlight">\(D_{ij}\)</span> = collision diameter (metres)</p></li>
<li><p><span class="math notranslate nohighlight">\(V_1, V_2\)</span> = vessel speeds on each leg</p></li>
</ul>
<p>The <strong>relative speed</strong> uses the law of cosines:</p>
<div class="math notranslate nohighlight">
\[V_{ij} = \sqrt{V_1^2 + V_2^2 - 2 V_1 V_2 \cos\theta}\]</div>
<p>The <strong>collision diameter</strong> accounts for the projected area of both
vessels at the crossing angle:</p>
<div class="math notranslate nohighlight">
\[D_{ij} = (L_1 + L_2) \times |\sin\theta|
        + (B_1 + B_2) \times |\cos\theta|\]</div>
<p>Where <span class="math notranslate nohighlight">\(L_1, L_2\)</span> are ship lengths and <span class="math notranslate nohighlight">\(B_1, B_2\)</span> are ship
beams.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When <span class="math notranslate nohighlight">\(\theta \to 0\)</span> or <span class="math notranslate nohighlight">\(\theta \to \pi\)</span> (parallel or
anti-parallel courses), <span class="math notranslate nohighlight">\(\sin\theta \to 0\)</span> and the crossing
formula is not applicable. Use head-on or overtaking formulas instead.</p>
</div>
<div class="source-code-ref docutils container">
<p><code class="docutils literal notranslate"><span class="pre">compute/basic_equations.py:238</span></code> – <a class="reference external" href="https://github.com/axelande/OMRAT/blob/main/compute/basic_equations.py#L238">get_crossing_collision_candidates()</a></p>
</div>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">Crossing collision with law of cosines (compute/basic_equations.py)</span><a class="headerlink" href="#id8" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># Handle edge cases for crossing angle</span>
    <span class="n">sin_theta</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np_abs</span><span class="p">(</span><span class="n">sin_theta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">:</span>
        <span class="c1"># Parallel or anti-parallel courses - use head-on or overtaking instead</span>
        <span class="k">return</span> <span class="mf">0.0</span>

    <span class="c1"># Relative speed using law of cosines</span>
    <span class="c1"># V_ij = √(V1² + V2² - 2×V1×V2×cos(θ))</span>
    <span class="n">V_ij</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">V1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V2</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">V1</span> <span class="o">*</span> <span class="n">V2</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">V_ij</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>

    <span class="c1"># Collision diameter based on ship dimensions and crossing angle</span>
    <span class="c1"># D_ij accounts for the projected area of both vessels</span>
    <span class="c1"># D_ij = (L1 + L2) × |sin(θ)| + (B1 + B2) × |cos(θ)|</span>
    <span class="n">D_ij</span> <span class="o">=</span> <span class="p">(</span><span class="n">L1</span> <span class="o">+</span> <span class="n">L2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np_abs</span><span class="p">(</span><span class="n">sin_theta</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">B1</span> <span class="o">+</span> <span class="n">B2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np_abs</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>

    <span class="c1"># Number of geometric collision candidates</span>
    <span class="c1"># Hansen Eq. 4.6: N_G = Q1 × Q2 × D_ij / (V1 × V2 × sin(θ))</span>
    <span class="c1"># Note: The formula divides by V1 × V2 to convert frequencies to densities</span>
    <span class="c1"># and includes sin(θ) to account for the crossing geometry</span>

    <span class="c1"># Avoid division by zero</span>
    <span class="k">if</span> <span class="n">V1</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">V2</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>

    <span class="c1"># Convert frequency to &quot;ships per year passing through intersection&quot;</span>
    <span class="c1"># For crossing, the formula is different from head-on/overtaking</span>
    <span class="c1"># N_G = Q1 × Q2 × D_ij / (V1 × V2 × sin(θ)) × conversion_factor</span>
    <span class="c1"># The conversion factor accounts for time: ships/year squared needs to become</span>
    <span class="c1"># collision candidates/year</span>

    <span class="c1"># Using dimensional analysis:</span>
    <span class="c1"># Q1, Q2 in ships/year; D_ij in meters; V1, V2 in m/s</span>
    <span class="c1"># Q1 × Q2 × D_ij / (V1 × V2) = ships²/year² × m / (m²/s²) = ships² × s² / (year² × m)</span>
    <span class="c1"># We need to multiply by (1/seconds_per_year) to get ships/year</span>
    <span class="n">seconds_per_year</span> <span class="o">=</span> <span class="mf">365.25</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span>
    <span class="n">N_G</span> <span class="o">=</span> <span class="n">Q1</span> <span class="o">*</span> <span class="n">Q2</span> <span class="o">*</span> <span class="n">D_ij</span> <span class="o">/</span> <span class="p">(</span><span class="n">V1</span> <span class="o">*</span> <span class="n">V2</span> <span class="o">*</span> <span class="n">np_abs</span><span class="p">(</span><span class="n">sin_theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">seconds_per_year</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">N_G</span>
</pre></div>
</div>
</div>
</section>
<section id="id4">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Default causation factor</a><a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<div class="math notranslate nohighlight">
\[P_C = 1.3 \times 10^{-4} \quad \text{(Pedersen 1995)}\]</div>
</section>
</section>
<section id="bend-collisions">
<h2><a class="toc-backref" href="#id22" role="doc-backlink">Bend Collisions</a><a class="headerlink" href="#bend-collisions" title="Link to this heading">¶</a></h2>
<p>Bend collisions occur at waypoints where a route changes direction. A
vessel that fails to make the turn continues on its original heading and
may collide with vessels that did turn correctly.</p>
<section id="id5">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">Geometry</a><a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p>At a waypoint, the route changes direction by angle <span class="math notranslate nohighlight">\(\theta\)</span>.
Most vessels turn correctly, but a small fraction <span class="math notranslate nohighlight">\(P_0\)</span> (typically
1%) fail to turn and continue straight.</p>
</section>
<section id="equations">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">Equations</a><a class="headerlink" href="#equations" title="Link to this heading">¶</a></h3>
<div class="math notranslate nohighlight">
\[Q_{\text{no turn}} = Q \times P_0\]</div>
<div class="math notranslate nohighlight">
\[Q_{\text{turn}} = Q \times (1 - P_0)\]</div>
<p>The bend collision is then modelled as a crossing collision between the
non-turning traffic and the turning traffic:</p>
<div class="math notranslate nohighlight">
\[N_{\text{bend}} = N_G^{\text{crossing}}(Q_{\text{no turn}},
                   Q_{\text{turn}}, \theta)\]</div>
<p>Where <span class="math notranslate nohighlight">\(\theta\)</span> is the bend angle (change in heading at the
waypoint) and the crossing collision formula is applied with
self-interaction (same ship type on both “legs”).</p>
<div class="source-code-ref docutils container">
<p><code class="docutils literal notranslate"><span class="pre">compute/basic_equations.py:331</span></code> – <a class="reference external" href="https://github.com/axelande/OMRAT/blob/main/compute/basic_equations.py#L331">get_bend_collision_candidates()</a></p>
</div>
</section>
<section id="id6">
<h3><a class="toc-backref" href="#id25" role="doc-backlink">Default causation factor</a><a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<div class="math notranslate nohighlight">
\[P_C = 1.3 \times 10^{-4} \quad \text{(Pedersen 1995)}\]</div>
<p>Default probability of not turning:</p>
<div class="math notranslate nohighlight">
\[P_0 = 0.01\]</div>
</section>
</section>
<section id="calculation-workflow">
<h2><a class="toc-backref" href="#id26" role="doc-backlink">Calculation Workflow</a><a class="headerlink" href="#calculation-workflow" title="Link to this heading">¶</a></h2>
<p>The collision calculation for each leg proceeds as follows:</p>
<ol class="arabic simple">
<li><p><strong>Extract traffic data</strong>: For each segment, extract all ship types,
frequencies, speeds, and dimensions in both directions.</p></li>
<li><p><strong>Pair ship types</strong>: For head-on and overtaking, pair every ship type
<span class="math notranslate nohighlight">\(i\)</span> in direction 1 with every ship type <span class="math notranslate nohighlight">\(j\)</span> in direction 2
(or same direction for overtaking).</p></li>
<li><p><strong>Calculate per-pair N_G</strong>: Apply the appropriate formula based on
encounter type, using the specific vessel speeds, beams, and lateral
distributions.</p></li>
<li><p><strong>Sum over all pairs</strong>: The total geometric candidates is the sum
over all ship type pairs.</p></li>
<li><p><strong>Apply causation factor</strong>: Multiply by <span class="math notranslate nohighlight">\(P_C\)</span> to get accident
frequency.</p></li>
<li><p><strong>Display results</strong>: Results are shown in the UI as annual accident
frequencies per collision type.</p></li>
</ol>
</section>
<section id="summary-of-equations">
<h2><a class="toc-backref" href="#id27" role="doc-backlink">Summary of Equations</a><a class="headerlink" href="#summary-of-equations" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 30.0%" />
<col style="width: 20.0%" />
<col style="width: 30.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Relative Speed</p></th>
<th class="head"><p>Lateral Offset</p></th>
<th class="head"><p>Key Parameter</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Head-on</p></td>
<td><p><span class="math notranslate nohighlight">\(V_1 + V_2\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_1 + \mu_2\)</span></p></td>
<td><p>Opposite directions</p></td>
</tr>
<tr class="row-odd"><td><p>Overtaking</p></td>
<td><p><span class="math notranslate nohighlight">\(V_f - V_s\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_f - \mu_s\)</span></p></td>
<td><p>Same direction, <span class="math notranslate nohighlight">\(V_f &gt; V_s\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Crossing</p></td>
<td><p><span class="math notranslate nohighlight">\(\sqrt{V_1^2+V_2^2-2V_1V_2\cos\theta}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(D_{ij}\)</span></p></td>
<td><p>Crossing angle <span class="math notranslate nohighlight">\(\theta\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Bend</p></td>
<td><p>(crossing formula)</p></td>
<td><p>(crossing formula)</p></td>
<td><p><span class="math notranslate nohighlight">\(P_0 = 0.01\)</span></p></td>
</tr>
</tbody>
</table>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;2022-2026, Axel Hörteborn / RISE.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/collisions.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>